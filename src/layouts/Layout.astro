---
export interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth bg-glass-bg dark:bg-dark-glass-bg">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Product Marketing Manager Portfolio - Showcasing strategic marketing expertise and measurable results" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>{title}</title>
    <style>
      /* Force exact background color for dark mode */
      html.dark,
      html.dark body,
      html.dark main {
        background-color: #050712 !important;
        background-image: none !important;
      }
      .dark .bg-dark-glass-bg {
        background-color: #050712 !important;
      }
      /* Force case study cards to use correct color */
      .dark .bg-dark-glass-card {
        background-color: #0d122b !important;
      }
    </style>
  </head>
  <body class="font-sans antialiased bg-glass-bg dark:bg-dark-glass-bg text-glass-gray-900 dark:text-dark-glass-gray-900 transition-colors duration-300">
    <slot />

    <script>
      // Theme toggle functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Check for saved theme preference or default to light mode
        const currentTheme = localStorage.getItem('theme') || 'light';

        // Apply the current theme immediately
        if (currentTheme === 'dark') {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      });

      // Global theme toggle function
      window.toggleTheme = function() {
        const isDark = document.documentElement.classList.contains('dark');

        if (isDark) {
          // Switch to light mode
          document.documentElement.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        } else {
          // Switch to dark mode
          document.documentElement.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        }

        // Update icon visibility
        updateThemeIcons();
      };

      // Update theme icons
      window.updateThemeIcons = function() {
        const isDark = document.documentElement.classList.contains('dark');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');

        if (sunIcon && moonIcon) {
          if (isDark) {
            sunIcon.classList.remove('hidden');
            moonIcon.classList.add('hidden');
          } else {
            sunIcon.classList.add('hidden');
            moonIcon.classList.remove('hidden');
          }
        }
      };

      // Cal.com Embed functionality
      document.addEventListener('DOMContentLoaded', function() {
        let selectedDuration = '30min'; // Default to 30 min

        // Load Cal.com embed script
        const script = document.createElement('script');
        script.src = 'https://app.cal.com/embed/embed.js';
        script.async = true;
        document.head.appendChild(script);

        function initializeCalEmbed() {
          if (typeof Cal !== 'undefined') {
            Cal("init", {
              origin: "https://app.cal.com"
            });

            loadCalendarEmbed();
          } else {
            // Retry after a short delay if Cal is not loaded yet
            setTimeout(initializeCalEmbed, 100);
          }
        }

        function loadCalendarEmbed() {
          const container = document.getElementById('cal-embed-container');
          if (!container) return;

          // Clear existing embed
          container.innerHTML = '<div id="cal-embed-target"></div>';

          // Initialize the Cal.com embed
          Cal("inline", {
            elementOrSelector: "#cal-embed-target",
            calLink: `francisco.contreras/${selectedDuration}`,
            config: {
              name: "Francisco Contreras",
              email: "contrerasfrancisco@icloud.com",
              notes: `Book a ${selectedDuration} consultation call`,
              guests: [],
              theme: "light"
            }
          });
        }

        // Call duration selection
        document.getElementById('call-15min')?.addEventListener('click', () => {
          selectedDuration = '15min';
          const btn15 = document.getElementById('call-15min');
          const btn30 = document.getElementById('call-30min');

          btn15.classList.add('bg-glass-primary/10', 'border-glass-primary/20');
          btn15.classList.remove('bg-glass-white/40', 'border-glass-white/40');
          btn30.classList.remove('bg-glass-primary/10', 'border-glass-primary/20');
          btn30.classList.add('bg-glass-white/40', 'border-glass-white/40');

          // Reload embed with new duration
          loadCalendarEmbed();
        });

        document.getElementById('call-30min')?.addEventListener('click', () => {
          selectedDuration = '30min';
          const btn15 = document.getElementById('call-15min');
          const btn30 = document.getElementById('call-30min');

          btn30.classList.add('bg-glass-primary/10', 'border-glass-primary/20');
          btn30.classList.remove('bg-glass-white/40', 'border-glass-white/40');
          btn15.classList.remove('bg-glass-primary/10', 'border-glass-primary/20');
          btn15.classList.add('bg-glass-white/40', 'border-glass-white/40');

          // Reload embed with new duration
          loadCalendarEmbed();
        });

        // Initialize Cal.com embed after script loads
        script.onload = initializeCalEmbed;
      });
    </script>
  </body>
</html>
